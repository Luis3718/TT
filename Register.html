<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro - SerenaMente IA</title>
    <link rel="stylesheet" href="styles/Register.css">
</head>
<body>
    <!-- Submenú y logo-->
    <header>
        <div class="header-container">
            <div class="logo-container">
                <img src="imagenes/logo.jpg" alt="Logo SerenaMente IA" class="logo">
            </div>
            <button class="menu-toggle" aria-label="Toggle Menu">
                &#9776; <!-- Icono de tres rayitas -->
            </button>
            <nav class="submenu">
                <ul>
                    <li><a href="Detalles.html">¿Qué es SerenaMente IA?</a></li>
                    <li><a href="QuienesSomos.html">¿Quiénes Somos?</a></li>
                    <li><a href="FAQS.html">FAQ's</a></li>
                    <li><a href="Login.html" class="login">Inicio de Sesión</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Contenido principal -->
    <main>
        <div class="container">
            <h1>Formulario de Registro</h1>
            <div class="form-section">
                <form id="registroForm">
                    <div class="question">
                        <label for="nombre">Nombre completo:</label>
                        <input type="text" id="nombre" name="Nombre" placeholder="Nombre(s) y apellidos" required>
                    </div>
                    <div class="question">
                        <label for="correo">Correo electrónico:</label>
                        <input type="email" id="correo" name="Correo" placeholder="ejemplo@correo.com" required>
                    </div>
                    <div class="question">
                        <label for="correo">Correo alternativo:</label>
                        <input type="email" id="correo" name="correo" placeholder="ejemplo@correo.com" required>
                    </div>
                    <div class="question">
                        <label for="contraseña">Contraseña:</label>
                        <input type="password" id="contraseña" name="Contraseña" required>
                    </div>
                    <div class="question">
                        <label for="celular">Celular:</label>
                        <input type="tel" id="celular" name="celular" pattern="[0-9]{10}" placeholder="10 dígitos" required>
                    </div>
                    <div class="question">
                        <label for="sexo">Sexo:</label>
                        <select id="sexo" name="Sexo" required>
                            <option value="Mujer">Mujer</option>
                            <option value="Hombre">Hombre</option>
                            <option value="Prefiero no decirlo">Prefiero no decirlo</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="fechaNacimiento">Fecha de nacimiento:</label>
                        <input type="date" id="fechaNacimiento" name="FechaNacimiento" required>
                    </div>
                    <div class="question">
                        <label for="nivelEstudios">Nivel de estudios:</label>
                        <select id="nivelEstudios" name="ID_NivelEstudios" required>
                            <option value="1">No estudié</option>
                            <option value="2">Primaria</option>
                            <option value="3">Secundaria</option>
                            <option value="4">Preparatoria</option>
                            <option value="5">Licenciatura</option>
                            <option value="6">Maestría</option>
                            <option value="7">Doctorado</option>
                            <option value="8">Otro</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="ocupacion">Ocupación:</label>
                        <select id="ocupacion" name="ID_Ocupacion" required>
                            <option value="1">Encargado(a) del hogar</option>
                            <option value="2">Estudiante</option>
                            <option value="3">Empleado(a)</option>
                            <option value="4">Desempleado(a)</option>
                            <option value="5">Autoempleo</option>
                            <option value="6">Profesionista</option>
                            <option value="7">Jubilado(a)</option>
                            <option value="8">Otro</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="residencia">Lugar de residencia:</label>
                        <select id="residencia" name="ID_Residencia" required>
                            <option value="1">Aguascalientes</option>
                            <option value="2">Baja California</option>
                            <option value="3">Baja California Sur</option>
                            <option value="4">Campeche</option>
                            <option value="5">Chiapas</option>
                            <option value="6">Chihuahua</option>
                            <option value="7">Ciudad de México</option>
                            <option value="8">Coahuila</option>
                            <option value="9">Colima</option>
                            <option value="10">Durango</option>
                            <option value="11">Estado de México</option>
                            <option value="12">Guanajuato</option>
                            <option value="13">Guerrero</option>
                            <option value="14">Hidalgo</option>
                            <option value="15">Jalisco</option>
                            <option value="16">Michoacán</option>
                            <option value="17">Morelos</option>
                            <option value="18">Nayarit</option>
                            <option value="19">Nuevo León</option>
                            <option value="20">Oaxaca</option>
                            <option value="21">Puebla</option>
                            <option value="22">Querétaro</option>
                            <option value="23">Quintana Roo</option>
                            <option value="24">San Luis Potosí</option>
                            <option value="25">Sinaloa</option>
                            <option value="26">Sonora</option>
                            <option value="27">Tabasco</option>
                            <option value="28">Tamaulipas</option>
                            <option value="29">Tlaxcala</option>
                            <option value="30">Veracruz</option>
                            <option value="31">Yucatán</option>
                            <option value="32">Zacatecas</option>
                            <option value="33">Extranjero</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="estadoCivil">Estado civil:</label>
                        <select id="estadoCivil" name="ID_EstadoCivil" required>
                            <option value="1">Soltero(a)</option>
                            <option value="2">Unión libre</option>
                            <option value="3">Casado(a)</option>
                            <option value="4">Divorciado(a)</option>
                            <option value="5">Separado(a)</option>
                            <option value="6">Viudo(a)</option>
                            <option value="7">Otro</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="enTratamiento">En tratamiento:</label>
                        <select id="enTratamiento" name="EnTratamiento" required>
                            <option value="ninguno">Ninguno</option>
                            <option value="psicológico">Psicológico</option>
                            <option value="psiquiátrico">Psiquiátrico</option>
                            <option value="ambos">Ambos</option>
                        </select>
                    </div>
                    <div class="question">
                        <label for="tomaMedicamentos">Toma medicamentos:</label>
                        <select id="tomaMedicamentos" name="TomaMedicamentos" required onchange="toggleMedicacionField()">
                            <option value="No">No</option>
                            <option value="No aplica">No aplica</option>
                            <option value="Sí">Sí</option>
                        </select>
                    </div>
                    <div class="question" id="medicacionField" style="display: none;">
                        <label for="nombreMedicacion">Nombre de medicación:</label>
                        <input type="text" id="nombreMedicacion" name="nombre_medicacion">
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="aviso_privacidad" name="aviso_privacidad" required>
                        <label for="aviso_privacidad">
                            He leído y acepto el <span class="aviso-privacidad" id="avisoPrivacidadLink">aviso de privacidad</span>.
                        </label>
                    </div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="carta_concentimiento" name="carta_concentimiento" required>
                        <label for="carta_concentimiento">
                            He leído y acepto el <span class="carta_concentimiento" id="carta_concentimientoLink">formato de consentimiento informado</span>.
                        </label>
                    </div>
                    <button type="submit">Registrar</button>
                </form>
            </div>
        </div>
    </main>

    <!-- Modal para Aviso de Privacidad -->
    <div id="modalAviso" class="modal">
        <div class="modal-content">
            <span class="close" id="closeAviso">&times;</span>
            <h1>Aviso de Privacidad Integral</h1>
            <p>La Facultad de Estudios Superiores Iztacala (FESI) de la Universidad Nacional Autónoma de México (UNAM),
                ubicada en Avenida de los Barrios No. 1, colonia Los Reyes Ixtacala, Tlalnepantla de Baz, Estado de México,
                C.P. 54090 y es responsable del tratamiento de sus datos personales. Recopilamos sus datos personales a
                través de los mecanismos remotos de comunicación electrónica, utilizando la página web y/o aplicación del
                proyecto "Aceptación y utilidad clínica de una intervención de telepsicología autoaplicada para la promoción
                del bienestar como elemento de prevención en salud mental". Los datos que podemos solicitar, y que no se
                consideran sensibles según la Ley General de Protección de Datos Personales en Posesión de Sujetos
                Obligados, son los siguientes:</p>
            <ul>
                <li>Identificativos</li>
                <li>Contacto</li>
                <li>De emergencia</li>
            </ul>
            <p>Además de los datos personales mencionados anteriormente, para las finalidades informadas en el presente
                Aviso de Privacidad, también se recopilarán los siguientes datos personales considerados sensibles y que,
                por lo tanto, requieren de una especial protección:</p>
            <p>Datos relativos a la salud mental: modo de vida, cuidado de la salud y psico-emocional.</p>
            <p>Los datos personales que recopilamos de usted serán utilizados para las siguientes finalidades:</p>
            <ul>
                <li>Difundir conocimientos científicos, culturales, tecnológicos y profesionales.</li>
                <li>Contactar a familiares o terceros en casos de emergencia.</li>
                <li>Atender a la comunidad universitaria a través de programas de prevención de accidentes, de nutrición, de
                    ayuda psicológica y la aplicación y/o revisión de exámenes médicos, cuando lo solicite.</li>
                <li>Elaborar expedientes únicos personales.</li>
                <li>Acreditar su identidad.</li>
                <li>Enviar notificaciones y hacer seguimiento respecto a los resultados obtenidos en la intervención.</li>
                <li>Transferencias de datos personales que, en su caso, se efectúen y sus finalidades.</li>
            </ul>
            <p>No se transferirán sus datos personales sin previo consentimiento del titular, salvo para cumplir con las
                obligaciones establecidas en el artículo 22 de la Ley General de Protección de Datos Personales en Posesión
                de Sujetos Obligados. Los artículos 6º, Base A, fracciones II y III, y 16, segundo párrafo, de la
                Constitución Política de los Estados Unidos Mexicanos; el 3º, fracción XXXIII, 16, 17, 18, 20, 21, 22, 23,
                26, 27 y 28 de la Ley General de Protección de Datos Personales en Posesión de Sujetos Obligados, así como
                los numerales del 5 al 19 de los Lineamientos para la Protección de Datos Personales en Posesión de la
                Universidad Nacional Autónoma de México, publicados en la Gaceta UNAM el 25 de febrero de
                2019.<br><br>Ejercicio de derechos ARCOP (Acceso, rectificación, cancelación, oposición y portabilidad al
                uso de sus datos personales).<br><br>Tiene derecho a conocer qué datos personales tenemos de usted, para qué
                los utilizamos y las condiciones del uso que les damos (Acceso). Asimismo, es su derecho solicitar la
                corrección de su información personal en caso de que esté desactualizada, sea inexacta o incompleta
                (Rectificación); que la eliminemos de nuestros registros o bases de datos cuando considere que la misma no
                está siendo utilizada adecuadamente (Cancelación); así como oponerse al uso de sus datos personales para
                fines específicos (Oposición). Estos derechos se conocen como derechos ARCO.<br><br>Para ejercer sus
                derechos de acceso, rectificación, cancelación y oposición puede acudir a la Unidad de Transparencia de la
                Universidad Nacional Autónoma de México, con domicilio en lado Norponiente del Circuito Estadio Olímpico sin
                número, a un costado del Anexo de la Facultad de Filosofía y Letras, Ciudad Universitaria, Alcaldía
                Coyoacán, C.P. 04510, Ciudad de México, o bien por medio de la Plataforma Nacional de Transparencia: <a
                    href="http://www.plataformadetransparencia.org.mx"
                    target="_blank">http://www.plataformadetransparencia.org.mx</a></p>

            <p>La determinación adoptada, se le comunicará en un plazo máximo de veinte días hábiles contados desde la fecha
                en que se recibió la solicitud, a efecto de que, si resulta procedente, haga efectiva la misma dentro de los
                quince días hábiles siguientes a que se comunique la respuesta.</p>
            <p>Puede revocar el consentimiento que, en su caso, nos haya otorgado para el tratamiento de sus datos
                personales. Sin embargo, es importante que tenga en cuenta que no en todos los casos atenderemos o
                concluyamos su solicitud de forma inmediata, ya que es posible que por alguna obligación legal requeriremos
                seguir tratando sus datos personales. Asimismo, usted deberá considerar que, para ciertos fines, la
                revocación de su consentimiento implicará que no le podamos seguir prestando el servicio del sistema en
                línea que nos solicitó, o la conclusión de su relación con nosotros.</p>
            <h3>Ejercicio de su Derecho a la Portabilidad de Datos Personales</h3>
            <p>Esta área universitaria actualmente no cuenta con formatos estructurados y comúnmente utilizados para la
                portabilidad de datos personales, en términos de lo dispuesto en el artículo 6 de los Lineamientos que
                establecen los parámetros, modalidades y procedimientos para la portabilidad de datos personales, por lo que
                no es posible, por el momento, ejercer la portabilidad de datos personales.</p>
            <h3>Cookies</h3>
            <p>Las cookies son archivos con una pequeña cantidad de datos que se utilizan comúnmente como identificadores
                únicos anónimos. Estos se envían a su navegador desde los sitios web que visita y se almacenan en la memoria
                interna de su dispositivo.<br><br>Este Servicio no utiliza estas "cookies" de forma explícita. Sin embargo,
                la aplicación puede usar código y bibliotecas de terceros que usan "cookies" para recopilar información y
                mejorar sus servicios. Tiene la opción de aceptar o rechazar estas cookies y saber cuándo se envía una
                cookie a su dispositivo. Si elige rechazar nuestras cookies, es posible que no pueda utilizar algunas partes
                de este Servicio.</p>
            <h3>Proveedores de servicio</h3>
            <p>Es posible que empleemos a empresas e individuos de terceros debido a las siguientes razones:</p>
            <ul>
                <li>Para facilitar nuestro Servicio;</li>
                <li>Para proporcionar el Servicio en nuestro nombre;</li>
                <li>Para realizar servicios relacionados con el Servicio; o</li>
                <li>Para ayudarnos a analizar cómo se utiliza nuestro Servicio.</li>
            </ul>
            <p>Queremos informar a los usuarios de este Servicio que estos terceros tienen acceso a su Información personal.
                El motivo es realizar las tareas que se les asignan en nuestro nombre. Sin embargo, están obligados a no
                divulgar ni utilizar la información para ningún otro fin.</p>
            <h3>Seguridad</h3>
            <p>Valoramos su confianza al proporcionarnos su información personal, por lo que nos esforzamos por utilizar
                medios comercialmente aceptables para protegerla. Pero recuerde que ningún método de transmisión por
                Internet, o método de almacenamiento electrónico es 100% seguro y confiable, y no podemos garantizar su
                seguridad absoluta.</p>
            <h3>Enlaces a otros sitios</h3>
            <p>Este Servicio puede contener enlaces a otros sitios. Si hace clic en un enlace de un tercero, será dirigido a
                ese sitio. Tenga en cuenta que estos sitios externos no son operados por nosotros. Por lo tanto, le
                recomendamos encarecidamente que revise la Política de privacidad de estos sitios web. No tenemos control ni
                asumimos ninguna responsabilidad por el contenido, las políticas de privacidad o las prácticas de los sitios
                o servicios de terceros.</p>
            <h3>Cambios a esta Política de privacidad</h3>
            <p>Es importante tener en cuenta que este aviso de privacidad puede sufrir modificaciones o actualizaciones, las
                cuales estarán disponibles en el sitio web del Proyecto en la sección de Aviso de Privacidad. Se recomienda
                consultar el Aviso de Privacidad Integral al menos semestralmente para estar actualizado sobre las
                condiciones y términos del mismo. También se invita a los usuarios a consultar el aviso de privacidad de la
                Facultad de Estudios Superiores Iztacala: <a href="https://www.iztacala.unam.mx/ap.php"
                    target="_blank">https://www.iztacala.unam.mx/ap.php</a></p>
        </div>
    </div>

    <!-- Modal para Carta de Consentimiento Informado -->
    <div id="modalCarta" class="modal">
        <div class="modal-content">
            <span class="close" id="closeCarta">&times;</span>
            <h1>Carta de Consentimiento Informado</h1>
            <p>Aquí debe ir el contenido completo de la carta de consentimiento informado. Puedes añadir secciones, párrafos, y lo que sea necesario para que quede claro y completo.</p>
        </div>
    </div>

    <!-- Modal para menores de edad -->
    <div id="modalMenores" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalMenores">&times;</span>
            <h2>Registro no permitido</h2>
            <p>Lamentablemente, este sistema solo está disponible para mayores de 18 años.</p>
        </div>
    </div>

    <!-- Modal para personas en tratamiento -->
    <div id="modalTratamiento" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalTratamiento">&times;</span>
            <h2>Registro no permitido</h2>
            <p>Lamentablemente, este sistema no puede ser utilizado por personas que se encuentren en tratamiento psicológico o psiquiátrico.</p>
        </div>
    </div>

    <!-- Modal para confirmación de correo -->
    <div id="modalConfirmacion" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModal">&times;</span>
            <h2>¡Registro exitoso!</h2>
            <p>Se ha enviado un correo de confirmación a la dirección proporcionada. Por favor, verifica tu correo y confirma tu registro.</p>
        </div>
    </div>

    <div class="social-bar">
        <a href="https://www.facebook.com" target="_blank" class="social-icon">
            <img src="imagenes/Logo_facebook.png" alt="Facebook">
        </a>
        <a href="https://www.instagram.com" target="_blank" class="social-icon">
            <img src="imagenes/Logo_instagram.png" alt="Instagram">
        </a>
        <a href="https://www.youtube.com" target="_blank" class="social-icon">
            <img src="imagenes/Logo_youtube.png" alt="YouTube">
        </a>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-text">
                <h3>¿Tienes dudas?</h3>
                <p>Si tienes más preguntas o dudas sobre cualquier tema, puedes contactarnos y seguro te responderemos.</p>
            </div>
            <div class="footer-buttons">
                <button class="footer-btn">Correo electrónico</button>
                <button class="footer-btn">Aviso de Privacidad</button>
            </div>
        </div>
    </footer>
    <script>
        // Abrir y cerrar modal de Aviso de Privacidad
        const avisoPrivacidadLink = document.getElementById('avisoPrivacidadLink');
        const modalAviso = document.getElementById('modalAviso');
        const closeAviso = document.getElementById('closeAviso');

        avisoPrivacidadLink.addEventListener('click', () => {
            modalAviso.style.display = 'block';
        });

        closeAviso.addEventListener('click', () => {
            modalAviso.style.display = 'none';
        });

        window.addEventListener('click', (event) => {
            if (event.target === modalAviso) {
                modalAviso.style.display = 'none';
            }
        });

        // Abrir y cerrar modal de Carta de Consentimiento Informado
        const cartaConcentimientoLink = document.getElementById('carta_concentimientoLink');
        const modalCarta = document.getElementById('modalCarta');
        const closeCarta = document.getElementById('closeCarta');

        cartaConcentimientoLink.addEventListener('click', () => {
            modalCarta.style.display = 'block';
        });

        closeCarta.addEventListener('click', () => {
            modalCarta.style.display = 'none';
        });

        window.addEventListener('click', (event) => {
            if (event.target === modalCarta) {
                modalCarta.style.display = 'none';
            }
        });

        function toggleMedicacionField() {
        const tomaMedicamentos = document.getElementById("tomaMedicamentos").value;
        const medicacionField = document.getElementById("medicacionField");

        if (tomaMedicamentos === "Sí") {
            medicacionField.style.display = "block";
        } else {
            medicacionField.style.display = "none";
        }
        }

        document.getElementById("registroForm").addEventListener("submit", async function (e) {
        e.preventDefault();
        const email = document.getElementById("correo").value;
        const fechaNacimiento = document.getElementById("fechaNacimiento").value;
        const enTratamiento = document.getElementById("enTratamiento").value;

        // Calcular la edad
        const hoy = new Date();
        const fechaNac = new Date(fechaNacimiento);
        const edad = hoy.getFullYear() - fechaNac.getFullYear();
        const mes = hoy.getMonth() - fechaNac.getMonth();
        if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNac.getDate())) {
            edad--;
        }

        // Mostrar modal para menores de edad
        if (edad < 18) {
            const modalMenores = document.getElementById("modalMenores");
            modalMenores.style.display = "block";

            // Cerrar modal
            document.getElementById("closeModalMenores").addEventListener("click", () => {
                modalMenores.style.display = "none";
            });

            window.addEventListener("click", (event) => {
                if (event.target === modalMenores) {
                    modalMenores.style.display = "none";
                }
            });

            return;
        }

        // Mostrar modal para personas en tratamiento
        if (enTratamiento !== "ninguno") {
            const modalTratamiento = document.getElementById("modalTratamiento");
            modalTratamiento.style.display = "block";

            // Cerrar modal
            document.getElementById("closeModalTratamiento").addEventListener("click", () => {
                modalTratamiento.style.display = "none";
            });

            window.addEventListener("click", (event) => {
                if (event.target === modalTratamiento) {
                    modalTratamiento.style.display = "none";
                }
            });

            return;
        }

        // Mostrar el modal de confirmación
        const modal = document.getElementById("modalConfirmacion");
        modal.style.display = "block";

        // Cerrar el modal de confirmación
        document.getElementById("closeModal").addEventListener("click", () => {
            modal.style.display = "none";
        });

        window.addEventListener("click", (event) => {
            if (event.target === modal) {
                modal.style.display = "none";
            }
        });

        // Llamada al backend para enviar el correo
        try {
            const response = await fetch("/api/send-email", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ email }),
            });

            if (!response.ok) {
                alert("Hubo un problema al enviar el correo. Por favor, intenta de nuevo.");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Error al conectarse con el servidor.");
        }
    });

    </script>
</body>
</html>
